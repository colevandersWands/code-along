<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>code along</title>

    <link rel="stylesheet" href="./bower_components/bootstrap/dist/css/bootstrap.min.css">

    <script src="./saving/init.js"></script>
    <script src="./saving/handlers.js"></script>

    <script src="./linking/ctr-c.js"></script>
    <script src="./linking/open-in-pytut.js"></script>
    <script src="./linking/permalinking.js"></script>

  </head>
  <body>
    <link rel="stylesheet" href="assets/droplet.css"/>
    <div class="container">
      <br>
      <div class="row">
        <div class="col-xs-6">
          <button class="btn btn-primary" id="toggle">Toggle Blocks</button>
        </div>
      </div>
      <br/>
      <div id="editor-wrapper" style="position:relative;width:100%;height:500px;border: 1px solid black;">
        <div id="editor"></div>
      </div>
      <div>
        <button onclick="save_snippet()">save snippet</button>
        run it: <button onclick="open_in_pytut();">in python tutor</button> <button onclick="copy_it();">in console</button> 
        study it with: <button onclick="open_in('parsonizer');">parsonizer</button>
        <button onclick="open_in('spot');">spot</button>  
        <button onclick="open_in('shuffle');">shuffle</button>
        <button onclick="open_in('flowviz');">flowviz</button>
        <button onclick="open_in('linter');">linter</button>  <br>
      </div>
      <hr>
      <div id="notes" style="position: relative; width: 800px; height: 400px;"></div>

      file name: <input id="file-name"></input>
      <button onclick="download_session()">download study session</button> <br>
      <button id="gen-perma" onclick="gen_permalink();">study session permalink:</button>
      <input id="display-perma"></input><br>
      


    </div>

    <br/>
    <hr>
    <p> <a href="https://github.com/janke-learning/code-along" target="_blank">code-along source code</a>, powered by <a href="https://github.com/droplet-editor/droplet" target="_blank">  droplet </a> & <a href="https://github.com/ajaxorg/ace" target="_blank">  ace </a>
    <br>
    <hr>  
    <hr>  
    <a href="http://janke-learning.org" target="_blank"><img src="https://user-images.githubusercontent.com/18554853/50098409-22575780-021c-11e9-99e1-962787adaded.png" width="40" height="40"></img> Janke Learning</a> 


    <script src="assets/ace/ace.js"></script>
    <script src="assets/droplet-full.js"></script>
    <script>
      var modes = {
        'javascript': {
          mode: 'javascript',
          modeOptions: {
            // functions: {
            //   fd: { command: true, color: 'red'},
            //   bk: { command: true, color: 'blue'},
            //   sin: { command: false, value: true, color: 'green' }
            // },
            // categories: {
            //   conditionals: { color: 'purple' },
            //   loops: { color: 'green' },
            //   functions: { color: '#49e' }
            // }
          },
          palette: [
            {
              'name': 'Variables',
              'color': 'blue',
              'blocks': [
                {'block': 'var a = 10;'},
                // {'block': 'let a = 10;'},
                // {'block': 'const a = 10;'},
                {'block': 'a = 10;'},
                {'block': 'a += 1;'},
                {'block': 'a -= 10;'},
                {'block': 'a *= 1;'},
                {'block': 'a /= 1;'}
              ]
            },
            {
              'name': 'Primitives',
              'color': 'green',
              'blocks': [
                {'block': 'typeof __'},
                {'block': 'void __'},
                {'block': 'Number(__)'},
                {'block': 'Boolean(__)'},
                {'block': 'String(__)'}
              ]
            },
            {
              'name': 'Logic',
              'color': 'teal',
              'blocks': [
                {'block': 'a || b'},
                {'block': 'a && b'},
                {'block': '!a'},
                {'block': 'a === b'},
                {'block': 'a !== b'},
                {'block': 'a > b'},
                {'block': 'a < b'},
                {'block': 'a >= b'},
                {'block': 'a <= b'},
              ]
            },
            {
              'name': 'Operators',
              'color': 'green',
              'blocks': [
                {'block': 'a + b'},
                {'block': 'a - b'},
                {'block': 'a * b'},
                {'block': 'a / b'},
                {'block': 'a % b'},
                {'block': 'a++'},
                {'block': '++a'},
                {'block': 'a--'},
                {'block': '--a'},
                // {'block': 'Math.pow(a, b)'},
                // {'block': 'Math.sin(a)'},
                // {'block': 'Math.tan(a)'},
                // {'block': 'Math.cos(a)'},
                // {'block': 'Math.random()'}
              ]
            },
            {
              'name': 'Control flow',
              'color': 'orange',
              'blocks': [
                {'block': 'if (a === b) {\n  __\n}'},
                {'block': 'if (a === b) {\n  __\n} else {\n  __\n}'},
                {'block': 'while (true) {\n  __\n}'},
                {'block': 'for (var i = 0; i < 10; i++) {\n  __\n}'},
              ]
            },
            {
              'name': 'Reference Types',
              'color': 'purple',
              'blocks': [
                // {'block': 'var arr = [__];'},
                {'block': 'arr[index]'},
                {'block': 'arr.push(__)'},
                {'block': 'arr.pop(__)'},
                {'block': 'arr.slice(__)'},
                {'block': 'obj.property'},
                {'block': 'obj[key]'},
                // {'block': 'Object.keys(__)'},
                // {'block': 'Object.values(__)'},
              ]
            },
            {
              'name': 'Functions',
              'color': 'purple',
              'blocks': [
                {'block': 'function myFunction(param) {\n  __\n}'},
                {'block': 'myFunction(arg);'},
                {'block': 'return __;'},
              ]
            },
            {
              'name': 'For Humans',
              'color': 'blue',
              'blocks': [
                {'block': 'console.log("hello");'},
                {'block': 'console.assert(a, b);'},
                {'block': '// comment'},
                // {'block': '/* __ */'},
              ]
            },
          ]
        }
      };

      var sessions = {};

      var editor = new droplet.Editor(document.getElementById('editor'), modes['javascript']);

      var notes = ace.edit("notes");

      notes.setTheme('ace/theme/chrome');
      notes.getSession().setMode('ace/mode/javascript');
      notes.setFontSize(13);
      notes.getSession().setTabSize(2);
      notes.setValue("/*  notes\n\n*/\n\n//  snippets\n\n")

      var query_snippet = read_query('snippet');
      var query_notes = read_query('notes');

      if (query_snippet) {
        editor.toggleBlocks()
        editor.setValue(decode_query(query_snippet));
      };
      if (query_notes) {
        notes.setValue(query_notes);
      };

      document.getElementById('toggle').addEventListener('click', function() {
        editor.toggleBlocks();
      });

    </script>
  </body>
</html>
